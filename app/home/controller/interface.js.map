{
    "version": 3,
    "sources": [
        "../../../src/home/controller/interface.js"
    ],
    "names": [
        "Enum",
        "queryAction",
        "pageNo",
        "get",
        "pageSize",
        "projectId",
        "queryText",
        "session",
        "userInfo",
        "think",
        "isEmpty",
        "fail",
        "NOT_NOGIN",
        "code",
        "msg",
        "where",
        "id",
        "_complex",
        "_logic",
        "model",
        "alias",
        "join",
        "page",
        "field",
        "countSelect",
        "result",
        "success",
        "pages",
        "totalCount",
        "totalPage",
        "tables",
        "count",
        "totalPages",
        "data",
        "addAction",
        "allParams",
        "add",
        "editAction",
        "update",
        "deleteAction",
        "delete"
    ],
    "mappings": "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",
    "file": "../../../src/home/controller/interface.js",
    "sourcesContent": [
        "'use strict';\n\nimport Base from './base.js';\nimport  * as Enum from '../../enum.js';\n\nexport default class extends Base {\n  /**\n   * index action\n   * @return {Promise} []\n   */\n  async queryAction(){\n    let pageNo = this.get(\"pageNo\");\n    let pageSize = this.get(\"pageSize\");\n    let projectId = this.get(\"projectId\");\n    let queryText = this.get(\"queryText\");\n    let userInfo = await this.session(\"userInfo\");\n    if(think.isEmpty(userInfo)) {\n      return this.fail(Enum.NOT_NOGIN.code, Enum.NOT_NOGIN.msg);\n    }\n    let where = {\"ua.userId\": userInfo.id};\n    if(!think.isEmpty(projectId)) {\n      where[\"p.id\"] = projectId;\n    }\n    if(!think.isEmpty(queryText)) {\n      // where[\"i.interfaceName\"] = [\"like\", \"%\" + queryText + \"%\"];\n      where._complex = {\n        \"i.interfaceName\": [\"like\", \"%\" + queryText + \"%\"],\n        \"i.url\": [\"like\", \"%\" + queryText + \"%\"],\n        _logic: \"or\"\n      };\n    }\n    var result = await this.model(\"interface\").alias('i').join([\n      'INNER JOIN project as p ON i.projectId=p.id',\n      'INNER JOIN userAuth as ua on p.id=ua.projectId'\n    ]).page(pageNo, pageSize).where(where)\n    .field(\"i.id,i.projectId,i.interfaceName,i.url,i.proxyUrl,i.requestType,i.openExact,i.params,i.result,i.code,i.openMock,i.openProxy,date_format(i.createTime, '%Y-%c-%d %h:%i:%s' ) as createTime,p.projectName,p.projectPrefix\")\n    .countSelect();\n    if(think.isEmpty(result)) {\n      return this.success({pages: {pageNo: pageNo, pageSize: pageSize, totalCount: 0, totalPage: 0}, tables: []});\n    }\n    return this.success({pages: {pageNo: pageNo, pageSize: pageSize, totalCount: result.count, totalPage: result.totalPages}, tables: result.data});\n  }\n\n  async addAction() {\n    //获取所有入参\n    let allParams = this.get();\n    //判断用户是否登录\n    let userInfo = await this.session(\"userInfo\");\n    if(think.isEmpty(userInfo)) {\n      return this.fail(Enum.NOT_NOGIN.code, Enum.NOT_NOGIN.msg);\n    }\n    await this.model(\"interface\").add(allParams);\n    return this.success();\n  }\n\n  async editAction() {\n    //获取所有入参\n    let allParams = this.get();\n    //判断用户是否登录\n    let userInfo = await this.session(\"userInfo\");\n    if(think.isEmpty(userInfo)) {\n      return this.fail(Enum.NOT_NOGIN.code, Enum.NOT_NOGIN.msg);\n    }\n    var id = allParams.id;\n    delete allParams.id;\n    await this.model(\"interface\").where({id: id}).update(allParams);\n    return this.success();\n  }\n\n  async deleteAction() {\n    let id = this.get(\"id\");\n    let userInfo = await this.session(\"userInfo\");\n    if(think.isEmpty(userInfo)) {\n      return this.fail(Enum.NOT_NOGIN.code, Enum.NOT_NOGIN.msg);\n    }\n    await this.model(\"interface\").where({id: id}).delete();\n    return this.success();\n  }\n}\n"
    ]
}